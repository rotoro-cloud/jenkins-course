---
layout: article
---
```groovy
pipeline {
    agent none
    stages {
        stage('first') {
            agent any
            input {
                message "Are you here?"
                ok "Submit"
            }
            steps {
                echo 'Ok'
            }
        }
        stage('second') {
            steps {
                sh "echo Now: $(date '+%Y-%m-%d %H:%M:%S')"
            }
        }
    }
}
```

Я поменял наш Jenkisfile и хочу реализовать очень жизненный кейс, а именно, что если пользователь не вводит данные дольше 30 секунд, то отменять сборку. Для этого мне понадобится механизм `input`, который ждет данные от запустившего пайплайн пользователя. Мы разберем `input`подробнее уже скоро в курсе.

Сейчас же я просто хочу ограничить время ввода, чтобы конвейер останавливался, если данные не введены больше 30 секунд. Я что-то слышал про опцию `timeout`, но совершенно не помню, как это использовать.

Ок, при создании pipeline ты наверное видел ссылку `pipeline-syntax`. Но эта штука не проверяет Jenkinsfile на синтаксис, т.к. проверка проходит автоматически. А вот нажав на эту ссылку ты попадёшь в интересное место, которое называется `Declarative Directive Generator`.

Здесь в разделе **options** мы можем посмотреть на представленные варианты и создать через форму декларативную команду, которую потом скопипастить себе в пайплайн.

Давай попробуем сгенерировать и добавить. Теперь мой пайплайн выглядит так:

```groovy
pipeline {
    agent none
    stages {
        stage('first') {
            agent any
            input {
                message "Are you here?"
                ok "Submit"
            }
            options {
                timeout(time: 30, unit: 'SECONDS')
            }
            steps {
                echo 'Ok'
            }
        }
        stage('second') {
            steps {
                sh "echo Now: $(date '+%Y-%m-%d %H:%M:%S')"
            }
        }
    }
}
```

Запущу на исполнение и зайду в логи. Как и ожидалось, по прошествии 30 секунд не дождавшись ввода наша сборка перешла в статус `ABORTED`.

На моей практике работы с Jenkins это достаточно частый кейс, поскольку многие пользователи могут забыть ввести параметры после запуска, а этот механизм своего рода предохранитель.

И это все, увидимся.

!!!!!1

https://www.youtube.com/watch?v=lCSMialN7kU

попробуем таймаут https://www.youtube.com/watch?v=OChOtpK0fUE
!!!!1
