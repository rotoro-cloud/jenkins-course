---
layout: article
---
Мы можем избрать один из общепринятых подходов, например сделать полные резервные копии и далее добавлять к ним инкрементальные или дифференциальные бэкапы.

Все эти разные подходы к резервному копированию будут работать с Jenkins, т.е. с самой его системой, а также с заданиями, что в нем исполняются. Но желание забэкапить всё и сразу может быть трудно осуществимо. У нас может быть множество агентов, в которых исполняются разные нагрузки, и нереально сохранить их все. Тогда, что бэкапить в первую очередь? Все зависит от того, какие цели мы преследуем.

- Первый вариант, для чего потребуется это сохранять - случай `Disaster recovery`. Т.е. произошла авария, и нам нужна полностью рабочая система. Хотелось бы вернуть систему как она была: данные с контроллера Jenkins, с его агентов. Неплохо бы иметь какую-то часть, которая описывает инфраструктуру под это, на случай, если мы потеряли и это.

- Второй момент, если у нас сломалась конфигурация, а мы этого сразу не заметили. Jenkins работает так, что подобные проблемы могут обнаружиться только после его перезагрузки, которая может наступить очень нескоро. Все это время сервер будет успешно работать. Неплохо иметь механизм сохранения, чтобы была возможность откатиться к предыдущей успешной версии конфигурации.

- Третий случай, если мы удалили какой-то важный файл, скажем плагин, без которого все встанет, а обновить его в силу каких-то причин нельзя.

По моему опыту второй и третий варианты случаются чаще, чем первый, когда мы лишаемся всего и сразу. Поэтому нужно нацеливаться на него, а дальше улучшать свою систему резервного копирования.

Имей в виду, что то, что находится на агентах, это не результаты работы конвейеров. Это лишь среды для сборки и кэшированные файлы. Ими обычно можно пожертвовать. Сами результаты работы,  т.е. артефакты лежат на контроллере. На нем также есть такие вещи, как плагины, которые обычно можно легко восстановить. Но это не всегда подходит, и, если плагины не занимают гиганский объем, для ускорения при восстановлении я бы их оставил.

Ок, здесь мы подходим к вопросу, что самое главное, что нужно бэкапить в Jenkins, это не рабочие нагрузки, исполняемые агентами, а каталог с сервера-контроллера `$JENKINS_HOME`.
